{"version":3,"file":"edit.js","sources":["pages/quote/edit.vue","../../../GameDo/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcXVvdGUvZWRpdC52dWU"],"sourcesContent":["<template>\n  <view class=\"edit-container\">\n    <loading-animation :loading=\"isLoading\" text=\"加载报价数据...\" />\n    \n    <view class=\"content-wrapper\" v-if=\"!isLoading\">\n      <!-- 页面标题 -->\n      <view class=\"page-header\">\n        <text class=\"page-title\">修改报价</text>\n        <text class=\"page-subtitle\">更新您对该产品的运输报价</text>\n      </view>\n    \n    <base-card class=\"form-card\">\n        <!-- 表单内容 -->\n      <view class=\"form-content\">\n        <base-input\n          v-model=\"form.forwarderName\"\n          label=\"货代公司名称\"\n          placeholder=\"请输入货代公司名称\"\n          :error=\"errors.forwarderName\"\n        />\n        \n        <base-input\n          v-model=\"form.shippingRoute\"\n          label=\"出运线路\"\n          placeholder=\"请输入出运线路\"\n          :error=\"errors.shippingRoute\"\n        />\n        \n        <base-input\n          v-model=\"form.deliveryTime\"\n          label=\"时效\"\n          placeholder=\"请输入时效（如：3-5天）\"\n          :error=\"errors.deliveryTime\"\n        />\n        \n        <view class=\"form-row\">\n          <base-input\n            v-model=\"form.pricePerKg\"\n            label=\"报价(元/kg)\"\n            type=\"digit\"\n            placeholder=\"请输入每公斤报价\"\n            :error=\"errors.pricePerKg\"\n          />\n          \n          <base-input\n            v-model=\"form.customsFee\"\n            label=\"报关费用(元/票)\"\n            type=\"digit\"\n            placeholder=\"请输入报关费用\"\n            :error=\"errors.customsFee\"\n          />\n        </view>\n        \n        <view class=\"form-row\">\n          <base-input\n            v-model=\"form.totalGrossWeight\"\n            label=\"总毛重(kg)\"\n            type=\"digit\"\n            placeholder=\"\"\n            :error=\"errors.totalGrossWeight\"\n            disabled\n          />\n          \n          <base-input\n            v-model=\"form.totalFreight\"\n            label=\"总运费(元)\"\n            type=\"digit\"\n            placeholder=\"自动计算\"\n            disabled\n          />\n          \n          <base-input\n            v-model=\"form.totalCost\"\n            label=\"总费用(元)\"\n            type=\"digit\"\n            placeholder=\"自动计算\"\n            disabled\n          />\n        </view>\n        \n        <base-input\n          v-model=\"form.remark\"\n          label=\"备注\"\n          type=\"textarea\"\n          placeholder=\"请输入备注信息（选填）\"\n          :error=\"errors.remark\"\n        />\n      </view>\n      </base-card>\n      \n      <!-- 费用摘要卡片 -->\n      <view class=\"summary-card\">\n        <view class=\"summary-title\">费用摘要</view>\n        <view class=\"summary-item\">\n          <text class=\"item-label\">运费单价</text>\n          <text class=\"item-value\">￥{{ form.pricePerKg || 0 }}/kg</text>\n        </view>\n        <view class=\"summary-item\">\n          <text class=\"item-label\">报关费用</text>\n          <text class=\"item-value\">￥{{ form.customsFee || 0 }}</text>\n        </view>\n        <view class=\"summary-divider\"></view>\n        <view class=\"summary-item total\">\n          <text class=\"item-label\">总费用</text>\n          <text class=\"item-value\">￥{{ form.totalCost || 0 }}</text>\n        </view>\n      </view>\n      \n      <!-- 底部操作按钮组 -->\n      <view class=\"action-buttons\">\n        <button class=\"action-btn secondary\" @click=\"handleCancel\">\n          <text class=\"btn-icon\">✖️</text>\n          <text>取消修改</text>\n        </button>\n        <button class=\"action-btn primary\" @click=\"handleSubmit\" :disabled=\"submitLoading\">\n          <text class=\"btn-icon\" v-if=\"!submitLoading\">✓</text>\n          <text v-if=\"submitLoading\" class=\"loading-icon\">⟳</text>\n          <text>{{ submitLoading ? '保存中...' : '保存修改' }}</text>\n        </button>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { get, put } from '../../utils/request'\nimport BaseCard from '../../components/BaseCard.vue'\nimport BaseButton from '../../components/BaseButton.vue'\nimport BaseInput from '../../components/BaseInput.vue'\nimport LoadingAnimation from '../../components/LoadingAnimation.vue'\n\nexport default {\n  name: 'QuoteEdit',\n  components: {\n    BaseCard,\n    BaseButton,\n    BaseInput,\n    LoadingAnimation\n  },\n  data() {\n    return {\n      quoteId: '',\n      isLoading: true,\n      submitLoading: false,\n      form: {\n        forwarderName: '',\n        shippingRoute: '',\n        deliveryTime: '',\n        pricePerKg: '',\n        customsFee: '',\n        totalGrossWeight: '',\n        totalFreight: '',\n        totalCost: '',\n        remark: ''\n      },\n      errors: {}\n    }\n  },\n  watch: {\n    'form.pricePerKg': {\n      handler: 'calculateTotal',\n      immediate: true\n    },\n    'form.customsFee': {\n      handler: 'calculateTotal',\n      immediate: true\n    }\n  },\n  onLoad(options) {\n    this.quoteId = options.quoteId\n    this.fetchQuoteDetail()\n  },\n  methods: {\n    async fetchQuoteDetail() {\n      this.isLoading = true\n      try {\n        const res = await get(`/quotes/${this.quoteId}`)\n        const quote = res.data\n        this.form = {\n          forwarderName: quote.forwarder_name,\n          shippingRoute: quote.shipping_route,\n          deliveryTime: quote.delivery_time,\n          pricePerKg: quote.price_per_kg,\n          customsFee: quote.customs_fee,\n          totalGrossWeight: quote.total_gross_weight,\n          totalFreight: quote.total_freight,\n          totalCost: quote.total_cost,\n          remark: quote.remark || ''\n        }\n      } catch (error) {\n        uni.showToast({\n          title: error.message || '获取报价详情失败',\n          icon: 'none'\n        })\n      } finally {\n        setTimeout(() => {\n          this.isLoading = false\n        }, 500)\n      }\n    },\n    \n    calculateTotal() {\n      const { pricePerKg, customsFee, totalGrossWeight } = this.form\n      \n      if (pricePerKg && totalGrossWeight) {\n        this.form.totalFreight = (Number(pricePerKg) * Number(totalGrossWeight)).toFixed(2)\n      }\n      \n      if (this.form.totalFreight && customsFee) {\n        this.form.totalCost = (Number(this.form.totalFreight) + Number(customsFee)).toFixed(2)\n      }\n    },\n    \n    validateForm() {\n      const errors = {}\n      \n      if (!this.form.forwarderName) {\n        errors.forwarderName = '请输入货代公司名称'\n      }\n      \n      if (!this.form.shippingRoute) {\n        errors.shippingRoute = '请输入出运线路'\n      }\n      \n      if (!this.form.deliveryTime) {\n        errors.deliveryTime = '请输入时效'\n      }\n      \n      if (!this.form.pricePerKg) {\n        errors.pricePerKg = '请输入每公斤报价'\n      } else if (isNaN(this.form.pricePerKg) || Number(this.form.pricePerKg) <= 0) {\n        errors.pricePerKg = '请输入有效的报价金额'\n      }\n      \n      if (!this.form.customsFee) {\n        errors.customsFee = '请输入报关费用'\n      } else if (isNaN(this.form.customsFee) || Number(this.form.customsFee) < 0) {\n        errors.customsFee = '请输入有效的报关费用'\n      }\n      \n      this.errors = errors\n      return Object.keys(errors).length === 0\n    },\n    \n    async handleSubmit() {\n      if (!this.validateForm()) {\n        return\n      }\n      \n      this.submitLoading = true\n      try {\n        await put(`/quotes/${this.quoteId}`, this.form)\n        \n        uni.showToast({\n          title: '修改成功',\n          icon: 'success'\n        })\n        \n        setTimeout(() => {\n          uni.navigateBack()\n        }, 1500)\n      } catch (error) {\n        uni.showToast({\n          title: error.message || '修改失败',\n          icon: 'none'\n        })\n      } finally {\n        this.submitLoading = false\n      }\n    },\n    \n    handleCancel() {\n      uni.navigateBack()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../styles/theme.scss';\n\n.edit-container {\n  min-height: 100vh;\n  background-color: $bg-secondary;\n  padding: $spacing-md;\n}\n\n.content-wrapper {\n  display: flex;\n  flex-direction: column;\n  gap: 24rpx;\n}\n\n.page-header {\n  background-color: #fff;\n  padding: 30rpx;\n  border-radius: 12rpx;\n  margin-bottom: 24rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0,0,0,0.05);\n  \n  .page-title {\n    font-size: 36rpx;\n    font-weight: bold;\n    color: $text-primary;\n    margin-bottom: 12rpx;\n    display: block;\n  }\n  \n  .page-subtitle {\n    font-size: 26rpx;\n    color: $text-secondary;\n  }\n}\n\n.form-card {\n  margin-bottom: 24rpx;\n}\n\n.form-content {\n  .form-row {\n    display: flex;\n    gap: $spacing-md;\n    margin-bottom: $spacing-md;\n    \n    .base-input {\n      flex: 1;\n    }\n  }\n}\n\n/* 费用摘要卡片 */\n.summary-card {\n  background-color: #fff;\n  padding: 30rpx;\n  border-radius: 12rpx;\n  margin-bottom: 24rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0,0,0,0.05);\n  \n  .summary-title {\n    font-size: 30rpx;\n    font-weight: bold;\n    color: $text-primary;\n    margin-bottom: 24rpx;\n  }\n  \n  .summary-item {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 16rpx;\n    \n    .item-label {\n      font-size: 26rpx;\n      color: $text-secondary;\n    }\n    \n    .item-value {\n      font-size: 26rpx;\n      color: $text-primary;\n    }\n    \n    &.total {\n      .item-label {\n        font-size: 30rpx;\n        font-weight: 500;\n      }\n      \n      .item-value {\n        font-size: 36rpx;\n        font-weight: bold;\n        color: #ff5252;\n      }\n    }\n  }\n  \n  .summary-divider {\n    height: 1rpx;\n    background-color: #eee;\n    margin: 20rpx 0;\n  }\n}\n\n/* 底部按钮组 */\n.action-buttons {\n  display: flex;\n  gap: 24rpx;\n  margin-top: 20rpx;\n  padding: 30rpx;\n  background-color: white;\n  border-radius: 16rpx;\n  box-shadow: 0 4rpx 12rpx rgba(0,0,0,0.05);\n  \n  .action-btn {\n    flex: 1;\n    height: 90rpx;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 45rpx;\n    font-size: 28rpx;\n    font-weight: 500;\n    \n    .btn-icon {\n      margin-right: 12rpx;\n      font-size: 32rpx;\n    }\n    \n    .loading-icon {\n      margin-right: 12rpx;\n      font-size: 32rpx;\n      animation: spin 1s infinite linear;\n    }\n    \n    &.secondary {\n      background-color: rgba(#f44336, 0.1);\n      color: #f44336;\n      border: 2rpx solid rgba(#f44336, 0.3);\n    }\n    \n    &.primary {\n      background-color: #1976D2;\n      color: white;\n      border: none;\n      box-shadow: 0 4rpx 16rpx rgba(#1976D2, 0.2);\n      \n      &:disabled {\n        opacity: 0.7;\n        background-color: #999;\n        box-shadow: none;\n      }\n    }\n  }\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n</style> ","import MiniProgramPage from 'D:/orderMySelf/product-price/product-price/pages/quote/edit.vue'\nwx.createPage(MiniProgramPage)"],"names":["get","uni","put"],"mappings":"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"}