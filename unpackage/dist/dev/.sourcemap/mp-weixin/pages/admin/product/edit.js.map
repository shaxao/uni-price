{"version":3,"file":"edit.js","sources":["pages/admin/product/edit.vue","../../../GameDo/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWRtaW4vcHJvZHVjdC9lZGl0LnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"admin-product-edit-container\">\n    <base-card class=\"form-card\">\n      <template #header>\n        <view class=\"page-header\">\n          <text class=\"page-title\">{{ isEdit ? '编辑产品' : '新增产品' }}</text>\n        </view>\n      </template>\n      <view class=\"form-content\">\n        <base-input v-model=\"form.product_name\" label=\"产品名称\" placeholder=\"请输入产品名称\" :error=\"errors.product_name\" />\n        <base-input v-model=\"form.product_id\" label=\"产品编号\" placeholder=\"请输入产品编号\" :error=\"errors.product_id\" :disabled=\"isEdit\" />\n        <base-input v-model=\"form.description\" label=\"产品描述\" placeholder=\"请输入产品描述\" :error=\"errors.description\" />\n        <view class=\"form-row\">\n          <base-input v-model=\"form.length\" label=\"长度(cm)\" type=\"number\" placeholder=\"\" :error=\"errors.length\" @input=\"autoCalc\" />\n          <base-input v-model=\"form.width\" label=\"宽度(cm)\" type=\"number\" placeholder=\"\" :error=\"errors.width\" @input=\"autoCalc\" />\n          <base-input v-model=\"form.height\" label=\"高度(cm)\" type=\"number\" placeholder=\"\" :error=\"errors.height\" @input=\"autoCalc\" />\n        </view>\n        <view class=\"form-row\">\n          <base-input v-model=\"form.gross_weight\" label=\"毛重(kg)\" type=\"number\" placeholder=\"\" :error=\"errors.gross_weight\" @input=\"autoCalc\" />\n          <base-input v-model=\"form.package_weight\" label=\"箱体重(kg)\" type=\"number\" placeholder=\"自动计算\" :error=\"errors.package_weight\" disabled />\n          <base-input v-model=\"form.chargeable_weight\" label=\"计费重(kg)\" type=\"number\" placeholder=\"自动计算\" :error=\"errors.chargeable_weight\" disabled />\n        </view>\n        <view class=\"form-row\">\n          <base-input v-model=\"form.quantity\" label=\"数量\" type=\"number\" placeholder=\"请输入数量\" :error=\"errors.quantity\" @input=\"autoCalc\" />\n          <base-input v-model=\"form.packing_quantity\" label=\"装箱量\" type=\"number\" placeholder=\"请输入装箱量\" :error=\"errors.packing_quantity\" @input=\"autoCalc\" />\n          <base-input v-model=\"form.total_quantity\" label=\"总件数\" type=\"number\" placeholder=\"请输入总件数\" :error=\"errors.total_quantity\" disabled />\n        </view>\n        <view class=\"form-row\">\n          <base-input v-model=\"form.total_volume\" label=\"总体积(m³)\" type=\"number\" placeholder=\"自动计算\" :error=\"errors.total_volume\" disabled />\n          <base-input v-model=\"form.total_gross_weight\" label=\"总毛重(kg)\" type=\"number\" placeholder=\"自动计算\" :error=\"errors.total_gross_weight\" disabled />\n        </view>\n        <base-input v-model=\"form.warehouse\" label=\"仓库地址\" placeholder=\"请输入仓库地址\" :error=\"errors.warehouse\" />\n        <base-input v-model=\"form.zipcode\" label=\"邮编\" placeholder=\"请输入邮编\" :error=\"errors.zipcode\" />\n        <view class=\"form-row\">\n          <view class=\"form-label\">产品图片</view>\n          <view class=\"image-upload\">\n            <image v-if=\"form.product_image\" :src=\"form.product_image\" class=\"product-image-preview\" />\n            <button class=\"upload-btn\" @click=\"chooseImage\">上传图片</button>\n          </view>\n        </view>\n        <view class=\"form-row\">\n          <view class=\"form-label\">状态</view>\n          <picker :range=\"statusOptions\" :value=\"form.statusIndex\" @change=\"onStatusChange\">\n            <view class=\"picker-value\">{{ statusOptions[form.statusIndex] }}</view>\n          </picker>\n        </view>\n      </view>\n      <template #footer>\n        <view class=\"form-footer\">\n          <button class=\"action-btn secondary\" @click=\"handleCancel\">取消</button>\n          <button class=\"action-btn primary\" @click=\"handleSubmit\">{{ isEdit ? '保存修改' : '添加产品' }}</button>\n        </view>\n      </template>\n    </base-card>\n  </view>\n</template>\n\n<script>\nimport BaseCard from '../../../components/BaseCard.vue'\nimport BaseInput from '../../../components/BaseInput.vue'\n\nexport default {\n  name: 'AdminProductEdit',\n  components: { BaseCard, BaseInput },\n  data() {\n    return {\n      isEdit: false,\n      form: {\n        product_id: '',\n        product_name: '',\n        description: '',\n        product_image: '',\n        length: '',\n        width: '',\n        height: '',\n        gross_weight: '',\n        package_weight: '',\n        chargeable_weight: '',\n        quantity: '',\n        packing_quantity: '',\n        total_quantity: '',\n        total_volume: '',\n        total_gross_weight: '',\n        warehouse: '',\n        zipcode: '',\n        status: 'on',\n        statusIndex: 0\n      },\n      statusOptions: ['上架', '下架'],\n      errors: {}\n    }\n  },\n  onLoad(options) {\n    if (options && options.id) {\n      this.isEdit = true\n      // TODO: 这里应从后端或store获取产品详情，现用mock\n      this.form = {\n        product_id: options.id,\n        product_name: '智能手表',\n        description: '多功能健康监测智能手表',\n        product_image: 'https://cdn.example.com/img/watch.jpg',\n        length: 10,\n        width: 5,\n        height: 2,\n        gross_weight: 0.2,\n        package_weight: '',\n        chargeable_weight: '',\n        quantity: 10,\n        packing_quantity: 12,\n        total_quantity: '',\n        total_volume: '',\n        total_gross_weight: '',\n        warehouse: '上海仓',\n        zipcode: '200000',\n        status: 'on',\n        statusIndex: 0\n      }\n      this.autoCalc()\n    }\n  },\n  methods: {\n    chooseImage() {\n      uni.chooseImage({\n        count: 1,\n        success: (res) => {\n          this.form.product_image = res.tempFilePaths[0]\n        }\n      })\n    },\n    onStatusChange(e) {\n      this.form.statusIndex = e.detail.value\n      this.form.status = this.form.statusIndex === 0 ? 'on' : 'off'\n    },\n    autoCalc() {\n      // 1. 箱体重 = 长*宽*高/6000\n      const l = Number(this.form.length) || 0\n      const w = Number(this.form.width) || 0\n      const h = Number(this.form.height) || 0\n      const gross = Number(this.form.gross_weight) || 0\n      const quantity = Number(this.form.quantity) || 0\n      const packing = Number(this.form.packing_quantity) || 0\n      // 箱体重\n      const packageWeight = l && w && h ? (l * w * h / 6000).toFixed(3) : ''\n      this.form.package_weight = packageWeight\n      // 计费重\n      const chargeableWeight = packageWeight && gross ? Math.max(Number(packageWeight), gross).toFixed(3) : ''\n      this.form.chargeable_weight = chargeableWeight\n      // 总件数 = 数量*装箱量\n      const totalQuantity = quantity && packing ? (quantity * packing) : ''\n      this.form.total_quantity = totalQuantity\n      // 总体积 = 长*宽*高*总件数/1000000\n      const totalVolume = l && w && h && totalQuantity ? (l * w * h * totalQuantity / 1000000).toFixed(3) : ''\n      this.form.total_volume = totalVolume\n      // 总毛重 = 计费重*总件数\n      const totalGrossWeight = chargeableWeight && totalQuantity ? (Number(chargeableWeight) * totalQuantity).toFixed(3) : ''\n      this.form.total_gross_weight = totalGrossWeight\n    },\n    validateForm() {\n      const errors = {}\n      if (!this.form.product_name) errors.product_name = '请输入产品名称'\n      if (!this.form.product_id) errors.product_id = '请输入产品编号'\n      if (!this.form.description) errors.description = '请输入产品描述'\n      if (!this.form.length) errors.length = '请输入长度'\n      if (!this.form.width) errors.width = '请输入宽度'\n      if (!this.form.height) errors.height = '请输入高度'\n      if (!this.form.gross_weight) errors.gross_weight = '请输入毛重'\n      if (!this.form.quantity) errors.quantity = '请输入数量'\n      if (!this.form.packing_quantity) errors.packing_quantity = '请输入装箱量'\n      if (!this.form.warehouse) errors.warehouse = '请输入仓库地址'\n      if (!this.form.zipcode) errors.zipcode = '请输入邮编'\n      this.errors = errors\n      return Object.keys(errors).length === 0\n    },\n    handleSubmit() {\n      if (!this.validateForm()) return\n      // TODO: 保存到后端或store\n      uni.showToast({ title: this.isEdit ? '修改成功' : '添加成功', icon: 'success' })\n      setTimeout(() => {\n        uni.navigateBack()\n      }, 1200)\n    },\n    handleCancel() {\n      uni.navigateBack()\n    }\n  },\n  watch: {\n    'form.length': 'autoCalc',\n    'form.width': 'autoCalc',\n    'form.height': 'autoCalc',\n    'form.gross_weight': 'autoCalc',\n    'form.quantity': 'autoCalc',\n    'form.packing_quantity': 'autoCalc'\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/theme.scss';\n.admin-product-edit-container {\n  min-height: 100vh;\n  background: $bg-secondary;\n  padding: 40rpx 24rpx;\n}\n.form-card {\n  border-radius: 16rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0,0,0,0.04);\n  margin-bottom: 32rpx;\n}\n.page-header {\n  padding: 36rpx 24rpx;\n  .page-title {\n    font-size: 38rpx;\n    font-weight: bold;\n    color: #222;\n  }\n}\n.form-content {\n  .form-row {\n    display: flex;\n    gap: 32rpx;\n    margin-bottom: 32rpx;\n    align-items: center;\n    .form-label {\n      font-size: 28rpx;\n      color: #666;\n      min-width: 120rpx;\n    }\n    .image-upload {\n      display: flex;\n      align-items: center;\n      gap: 18rpx;\n      .product-image-preview {\n        width: 120rpx;\n        height: 120rpx;\n        border-radius: 12rpx;\n        object-fit: cover;\n        background: #f5f5f5;\n      }\n      .upload-btn {\n        height: 60rpx;\n        padding: 0 24rpx;\n        border-radius: 8rpx;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 28rpx;\n        background: #1976d2;\n        color: #fff;\n        border: none;\n      }\n    }\n    .picker-value {\n      font-size: 28rpx;\n      color: #1976d2;\n      padding: 12rpx 24rpx;\n      background: #f5f5f5;\n      border-radius: 8rpx;\n      min-width: 120rpx;\n    }\n  }\n}\n.form-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 32rpx;\n  margin-top: 32rpx;\n  .action-btn {\n    height: 80rpx;\n    min-width: 160rpx;\n    border-radius: 40rpx;\n    font-size: 30rpx;\n    font-weight: 500;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    &.secondary {\n      background: #fbe9e7;\n      color: #f44336;\n      border: none;\n    }\n    &.primary {\n      background: #1976d2;\n      color: #fff;\n      border: none;\n    }\n  }\n}\n</style> ","import MiniProgramPage from 'D:/orderMySelf/product-price/product-price/pages/admin/product/edit.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}