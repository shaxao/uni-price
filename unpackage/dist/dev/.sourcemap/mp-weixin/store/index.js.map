{"version":3,"file":"index.js","sources":["store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\nimport user from './modules/user'\nimport product from './modules/product'\nimport quote from './modules/quote'\n\n// 内联购物车模块\nconst cart = {\n  namespaced: true,\n  state: {\n    cartItems: [],\n    loading: false,\n    error: null\n  },\n  mutations: {\n    SET_CART_ITEMS(state, items) {\n      state.cartItems = items\n    },\n    SET_LOADING(state, status) {\n      state.loading = status\n    },\n    SET_ERROR(state, error) {\n      state.error = error\n    },\n    ADD_CART_ITEM(state, item) {\n      state.cartItems.push(item)\n    },\n    REMOVE_CART_ITEM(state, index) {\n      state.cartItems.splice(index, 1)\n    },\n    CLEAR_CART(state) {\n      state.cartItems = []\n    }\n  },\n  actions: {\n    // 从本地存储加载购物车数据\n    loadCartItems({ commit }) {\n      commit('SET_LOADING', true)\n      try {\n        const cartItems = uni.getStorageSync('cartItems') || []\n        commit('SET_CART_ITEMS', cartItems)\n      } catch (error) {\n        commit('SET_ERROR', error.message)\n      } finally {\n        commit('SET_LOADING', false)\n      }\n    },\n\n    // 添加商品到购物车\n    addToCart({ commit, state }, product) {\n      try {\n        // 检查商品是否已在购物车中\n        const existingIndex = state.cartItems.findIndex(item => item.productId === product.productId)\n\n        if (existingIndex !== -1) {\n          return {\n            success: false,\n            message: '该商品已在购物车中'\n          }\n        }\n\n        // 添加新商品\n        const cartItem = {\n          productId: product.productId,\n          productName: product.productName,\n          addTime: new Date().getTime()\n        }\n\n        commit('ADD_CART_ITEM', cartItem)\n\n        // 保存到本地存储\n        uni.setStorageSync('cartItems', state.cartItems)\n\n        return {\n          success: true,\n          message: '已加入购物车'\n        }\n      } catch (error) {\n        commit('SET_ERROR', error.message)\n        return {\n          success: false,\n          message: '添加失败，请重试'\n        }\n      }\n    },\n\n    // 从购物车中移除商品\n    removeCartItem({ commit, state }, index) {\n      try {\n        commit('REMOVE_CART_ITEM', index)\n\n        // 保存到本地存储\n        uni.setStorageSync('cartItems', state.cartItems)\n\n        return {\n          success: true,\n          message: '删除成功'\n        }\n      } catch (error) {\n        commit('SET_ERROR', error.message)\n        return {\n          success: false,\n          message: '删除失败'\n        }\n      }\n    },\n\n    // 清空购物车\n    clearCart({ commit }) {\n      try {\n        commit('CLEAR_CART')\n\n        // 保存到本地存储\n        uni.setStorageSync('cartItems', [])\n\n        return {\n          success: true,\n          message: '购物车已清空'\n        }\n      } catch (error) {\n        commit('SET_ERROR', error.message)\n        return {\n          success: false,\n          message: '操作失败'\n        }\n      }\n    }\n  },\n  getters: {\n    cartItemCount: state => state.cartItems.length\n  }\n}\n\nconst store = createStore({\n  modules: {\n    user,\n    product,\n    quote,\n    cart\n  }\n})\n\nexport default store"],"names":["uni","createStore","user","product","quote"],"mappings":";;;;;AAMA,MAAM,OAAO;AAAA,EACX,YAAY;AAAA,EACZ,OAAO;AAAA,IACL,WAAW,CAAE;AAAA,IACb,SAAS;AAAA,IACT,OAAO;AAAA,EACR;AAAA,EACD,WAAW;AAAA,IACT,eAAe,OAAO,OAAO;AAC3B,YAAM,YAAY;AAAA,IACnB;AAAA,IACD,YAAY,OAAO,QAAQ;AACzB,YAAM,UAAU;AAAA,IACjB;AAAA,IACD,UAAU,OAAO,OAAO;AACtB,YAAM,QAAQ;AAAA,IACf;AAAA,IACD,cAAc,OAAO,MAAM;AACzB,YAAM,UAAU,KAAK,IAAI;AAAA,IAC1B;AAAA,IACD,iBAAiB,OAAO,OAAO;AAC7B,YAAM,UAAU,OAAO,OAAO,CAAC;AAAA,IAChC;AAAA,IACD,WAAW,OAAO;AAChB,YAAM,YAAY,CAAE;AAAA,IACrB;AAAA,EACF;AAAA,EACD,SAAS;AAAA;AAAA,IAEP,cAAc,EAAE,UAAU;AACxB,aAAO,eAAe,IAAI;AAC1B,UAAI;AACF,cAAM,YAAYA,cAAG,MAAC,eAAe,WAAW,KAAK,CAAE;AACvD,eAAO,kBAAkB,SAAS;AAAA,MACnC,SAAQ,OAAO;AACd,eAAO,aAAa,MAAM,OAAO;AAAA,MACzC,UAAgB;AACR,eAAO,eAAe,KAAK;AAAA,MAC5B;AAAA,IACF;AAAA;AAAA,IAGD,UAAU,EAAE,QAAQ,MAAK,GAAI,SAAS;AACpC,UAAI;AAEF,cAAM,gBAAgB,MAAM,UAAU,UAAU,UAAQ,KAAK,cAAc,QAAQ,SAAS;AAE5F,YAAI,kBAAkB,IAAI;AACxB,iBAAO;AAAA,YACL,SAAS;AAAA,YACT,SAAS;AAAA,UACV;AAAA,QACF;AAGD,cAAM,WAAW;AAAA,UACf,WAAW,QAAQ;AAAA,UACnB,aAAa,QAAQ;AAAA,UACrB,UAAS,oBAAI,KAAM,GAAC,QAAS;AAAA,QAC9B;AAED,eAAO,iBAAiB,QAAQ;AAGhCA,sBAAAA,MAAI,eAAe,aAAa,MAAM,SAAS;AAE/C,eAAO;AAAA,UACL,SAAS;AAAA,UACT,SAAS;AAAA,QACV;AAAA,MACF,SAAQ,OAAO;AACd,eAAO,aAAa,MAAM,OAAO;AACjC,eAAO;AAAA,UACL,SAAS;AAAA,UACT,SAAS;AAAA,QACV;AAAA,MACF;AAAA,IACF;AAAA;AAAA,IAGD,eAAe,EAAE,QAAQ,MAAK,GAAI,OAAO;AACvC,UAAI;AACF,eAAO,oBAAoB,KAAK;AAGhCA,sBAAAA,MAAI,eAAe,aAAa,MAAM,SAAS;AAE/C,eAAO;AAAA,UACL,SAAS;AAAA,UACT,SAAS;AAAA,QACV;AAAA,MACF,SAAQ,OAAO;AACd,eAAO,aAAa,MAAM,OAAO;AACjC,eAAO;AAAA,UACL,SAAS;AAAA,UACT,SAAS;AAAA,QACV;AAAA,MACF;AAAA,IACF;AAAA;AAAA,IAGD,UAAU,EAAE,UAAU;AACpB,UAAI;AACF,eAAO,YAAY;AAGnBA,4BAAI,eAAe,aAAa,EAAE;AAElC,eAAO;AAAA,UACL,SAAS;AAAA,UACT,SAAS;AAAA,QACV;AAAA,MACF,SAAQ,OAAO;AACd,eAAO,aAAa,MAAM,OAAO;AACjC,eAAO;AAAA,UACL,SAAS;AAAA,UACT,SAAS;AAAA,QACV;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACD,SAAS;AAAA,IACP,eAAe,WAAS,MAAM,UAAU;AAAA,EACzC;AACH;AAEK,MAAC,QAAQC,cAAAA,YAAY;AAAA,EACxB,SAAS;AAAA,IACX,MAAIC,mBAAI;AAAA,IACR,SAAIC,sBAAO;AAAA,IACX,OAAIC,oBAAK;AAAA,IACL;AAAA,EACD;AACH,CAAC;;"}